System.register(["@main"],(function(t,e){"use strict";var i;e&&e.id;return{setters:[function(t){}],execute:function(){t("LocaleSwitchModal",i=class{constructor(t,e={}){Object.defineProperty(this,"el",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:{type:"",table:"",routeName:"",currentId:"",defaultId:"",inputId:"",langField:"",titleField:"",triggerInputName:"lang_assoc"}}),this.options=Object.assign({},this.options,e);let i=this.el.querySelectorAll("[data-task=create_lang_version]");u.each(i,(t=>{t.addEventListener("click",(e=>{this.saveCurrentAndCreateLang(t)}))})),i=this.el.querySelectorAll("[data-task=switch_lang]"),u.each(i,(t=>{t.addEventListener("click",(e=>{this.switchLang(t)}))}))}validateForm(){const t=document.querySelector("#"+this.options.inputId).form;if(!t)return;if(!u.$validation.get(t).validateAll())throw alert(u.__("luna.field.locale.switch.message.form.invalid")),new Error("Form invalid");return t}saveCurrentAndCreateLang(t){const e=this.validateForm();u.form(e).post(null,{[this.options.triggerInputName]:{task:"create",type:this.options.type,table:this.options.table,routeName:this.options.routeName,code:t.dataset.lang,copy:t.dataset.copy,langField:this.options.langField,titleField:this.options.titleField,currentId:this.options.currentId,defaultId:this.options.defaultId}})}switchLang(t){const e=this.validateForm();u.form(e).post(null,{[this.options.triggerInputName]:{task:"switch",table:this.options.table,routeName:this.options.routeName,targetId:t.dataset.targetId}})}}),u.directive("locale-switch-modal",{mounted(t,{value:e}){const a=JSON.parse(e);u.module(t,"locale.switch",(()=>new i(t,a)))}})}}}));